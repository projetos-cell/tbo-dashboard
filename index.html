<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="TBO OS - Sistema operacional do estudio TBO Arquitetura & Visualizacao">
  <title>TBO OS - Painel de Comando</title>

  <!-- Resource Hints: preconnect para CDNs e Supabase (v2.1 performance) -->
  <link rel="preconnect" href="https://olnndpultyllyhzxuyxh.supabase.co" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="dns-prefetch" href="https://olnndpultyllyhzxuyxh.supabase.co">

  <!-- Preload critical assets (fetched early, applied when needed) -->
  <link rel="preload" as="style" href="styles.css?v=2026022003">
  <link rel="preload" as="image" href="assets/logo-dark.svg">

  <!-- Typography: Helvetica Neue LT Pro (local brand font) -->

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="assets/favicon.png">

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css?v=2026022003">

  <!-- Leaflet CSS (loaded early for layout, JS deferred below) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css" crossorigin="anonymous" />

  <!-- Preload critical CDN scripts -->
  <link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.49.1/dist/umd/supabase.min.js" crossorigin="anonymous">
  <link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/lucide@0.468.0/dist/umd/lucide.js" crossorigin="anonymous">

  <!-- CDN Libraries (defer = non-blocking, execute in order after HTML parsed) -->
  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.49.1/dist/umd/supabase.min.js" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/lucide@0.468.0/dist/umd/lucide.js" crossorigin="anonymous"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js" crossorigin="anonymous"></script>

  <!-- Prevenir flash do login: esconder overlay e sidebar ate JS decidir -->
  <style>
    .login-overlay { visibility: hidden; opacity: 0; transition: opacity .2s ease, visibility .2s ease; }
    .login-overlay.visible { visibility: visible; opacity: 1; }
    .login-overlay.hidden { visibility: hidden; opacity: 0; }
    /* Esconder app ate autenticacao resolvida */
    body.auth-pending #sidebar,
    body.auth-pending #app-container { opacity: 0; pointer-events: none; }
    body.auth-resolved #sidebar,
    body.auth-resolved #app-container { opacity: 1; transition: opacity .25s ease; }
  </style>
</head>
<body class="auth-pending">

  <!-- Accessibility: Skip link -->
  <a href="#main-content" class="skip-link">Pular para conteúdo</a>

  <!-- Accessibility: ARIA live region for dynamic announcements -->
  <div id="ariaLiveRegion" class="aria-live-region" aria-live="polite" aria-atomic="true"></div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- SIDEBAR NAVIGATION                                      -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <aside id="sidebar" class="sidebar" role="complementary" aria-label="Barra lateral">
    <!-- Brand — click to return to Dashboard -->
    <a href="#dashboard" class="sidebar-brand" id="brandLink" aria-label="Voltar ao Dashboard">
      <img class="brand-logo-svg" src="assets/logo-dark.svg" alt="TBO - think. build. own" draggable="false">
      <span class="brand-label">Operating System</span>
    </a>

    <!-- Botao Criar (Asana-style) -->
    <div class="sidebar-create" id="sidebarCreate">
      <button class="sidebar-create-btn" id="sidebarCreateBtn" title="Criar novo">
        <i data-lucide="plus" aria-hidden="true"></i>
        <span class="sidebar-create-label">Criar</span>
      </button>
      <div class="sidebar-create-dropdown" id="sidebarCreateDropdown">
        <button class="sidebar-create-option" data-create="projeto">
          <i data-lucide="folder-plus"></i>
          <span>Novo Projeto</span>
        </button>
        <button class="sidebar-create-option" data-create="tarefa">
          <i data-lucide="check-square"></i>
          <span>Nova Tarefa</span>
        </button>
        <button class="sidebar-create-option" data-create="contato">
          <i data-lucide="user-plus"></i>
          <span>Novo Contato</span>
        </button>
        <button class="sidebar-create-option" data-create="deal">
          <i data-lucide="handshake"></i>
          <span>Novo Deal</span>
        </button>
      </div>
    </div>

    <!-- Busca rapida inline -->
    <div class="sidebar-search" id="sidebarSearch">
      <input type="text" class="sidebar-search-input" id="sidebarSearchInput" placeholder="Buscar..." autocomplete="off" spellcheck="false">
      <svg class="sidebar-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
      <button class="sidebar-search-clear" id="sidebarSearchClear" title="Limpar busca">&times;</button>
      <span class="sidebar-search-kbd">/</span>
    </div>

    <!-- Favoritos (pinned) -->
    <div class="sidebar-favorites" id="sidebarFavorites" data-count="0">
      <div class="sidebar-favorites-header">
        <svg viewBox="0 0 24 24" fill="currentColor" stroke="none" width="12" height="12"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
        <span>FAVORITOS</span>
      </div>
      <ul class="sidebar-favorites-list" id="sidebarFavoritesList"></ul>
    </div>

    <!-- Navigation Modules (generated dynamically by app.js from permissions._sections) -->
    <div class="sidebar-nav-wrapper" id="sidebarNavWrapper">
      <nav class="sidebar-nav" id="sidebarNav">
        <!-- Populated by TBO_APP._renderSidebar() after login -->
      </nav>
    </div>

    <!-- Virtual tooltip (reusado por JS) -->
    <div class="sidebar-tooltip" id="sidebarTooltip"></div>
    <!-- Context menu (right-click) -->
    <div class="sidebar-context-menu" id="sidebarContextMenu"></div>
    <!-- Mini preview (hover prolongado) -->
    <div class="sidebar-mini-preview" id="sidebarMiniPreview"></div>

    <!-- Sidebar Footer (apenas collapse btn) -->
    <div class="sidebar-footer">
      <button class="sidebar-collapse-btn" id="sidebarToggle" title="Recolher menu" aria-label="Recolher barra lateral">
        <i data-lucide="chevron-left" aria-hidden="true"></i>
      </button>
    </div>

    <!-- Sidebar Resize Handle -->
    <div class="sidebar-resize-handle" id="sidebarResizeHandle" title="Arrastar para redimensionar"></div>
  </aside>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- MAIN LAYOUT                                             -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div id="app-container" class="app-container">

    <!-- ─────────────────────────────────────────────────── -->
    <!-- HEADER                                                -->
    <!-- ─────────────────────────────────────────────────── -->
    <header id="app-header" class="app-header" role="banner">
      <div class="header-left">
        <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Abrir menu" aria-expanded="false">
          <i data-lucide="menu" aria-hidden="true"></i>
        </button>
        <span class="header-breadcrumb" id="headerBreadcrumb"></span>
      </div>

      <div class="header-right">
        <!-- Status Indicators -->
        <div class="status-indicators" role="status" aria-label="Status dos servicos">
          <div class="status-badge" id="statusDrive" title="Google Drive">
            <span class="status-dot" data-status="disconnected"></span>
            <span class="status-label">Drive</span>
          </div>
          <div class="status-badge" id="statusFireflies" title="Fireflies.ai">
            <span class="status-dot" data-status="disconnected"></span>
            <span class="status-label">Fireflies</span>
          </div>
          <div class="status-badge" id="statusMarket" title="Dados de mercado">
            <span class="status-dot" data-status="stale"></span>
            <span class="status-label">Mercado</span>
          </div>
          <div class="status-badge" id="statusAPI" title="Chave de API">
            <span class="status-dot" data-status="disconnected"></span>
            <span class="status-label">API</span>
          </div>
          <div class="status-badge" id="statusSheets" title="Google Sheets (Financeiro)" style="cursor:pointer;">
            <span class="status-dot" data-status="disconnected"></span>
            <span class="status-label">Sheets</span>
          </div>
        </div>

        <!-- Data Freshness -->
        <div class="header-freshness" id="dataFreshness" title="Última atualização dos dados">
          <i data-lucide="clock" class="freshness-icon" aria-hidden="true"></i>
          <span class="freshness-text">--</span>
        </div>

        <!-- Quick Actions -->
        <button class="header-action-btn" id="refreshBtn" title="Atualizar dados" aria-label="Atualizar dados">
          <i data-lucide="refresh-cw" aria-hidden="true"></i>
        </button>
        <button class="header-action-btn" id="searchBtn" title="Busca rápida" aria-label="Abrir busca rápida">
          <i data-lucide="search" aria-hidden="true"></i>
        </button>

        <!-- User Menu (populated dynamically by auth.js) -->
        <div class="user-menu" id="userMenu"></div>
      </div>
    </header>

    <!-- ─────────────────────────────────────────────────── -->
    <!-- MAIN CONTENT AREA                                     -->
    <!-- ─────────────────────────────────────────────────── -->
    <main id="main-content" class="main-content" aria-live="polite">
      <!-- Module content loads here dynamically -->
      <div class="module-loading" id="moduleLoading">
        <div class="loading-spinner"></div>
        <p class="loading-text">Carregando módulo...</p>
      </div>

      <div class="module-container" id="moduleContainer">
        <!-- Active module renders here -->
      </div>

      <!-- Empty state / Welcome -->
      <div class="module-empty" id="moduleEmpty" style="display:none;">
        <div class="empty-illustration" aria-hidden="true">&#x1F3DB;&#xFE0F;</div>
        <h2 class="empty-title">Bem-vindo ao TBO OS</h2>
        <p class="empty-description">
          Selecione um módulo na barra lateral para começar.
          <br>
          Use <kbd>Alt+1</kbd> a <kbd>Alt+8</kbd> para navegar rapidamente.
        </p>
      </div>
    </main>

    <!-- ─────────────────────────────────────────────────── -->
    <!-- SEARCH MODAL (Quick Command Palette)                  -->
    <!-- ─────────────────────────────────────────────────── -->
    <div class="search-overlay" id="searchOverlay" role="dialog" aria-modal="true" aria-label="Busca rápida" hidden>
      <div class="search-modal">
        <div class="search-input-wrapper">
          <i data-lucide="search" class="search-input-icon" aria-hidden="true"></i>
          <input
            type="text"
            id="searchInput"
            class="search-input"
            placeholder="Buscar módulos, projetos, clientes..."
            autocomplete="off"
            spellcheck="false"
          >
          <kbd class="search-dismiss-hint">Esc</kbd>
        </div>
        <div class="search-filters" id="searchFilters">
          <button class="search-filter-chip active" data-filter="all">Tudo</button>
          <button class="search-filter-chip" data-filter="projeto_ativo">Projetos</button>
          <button class="search-filter-chip" data-filter="cliente">Clientes</button>
          <button class="search-filter-chip" data-filter="reuniao">Reuniões</button>
          <button class="search-filter-chip" data-filter="modulo">Módulos</button>
        </div>
        <div class="search-results" id="searchResults">
          <div class="search-hint">
            Digite para buscar ou use atalhos:
            <span class="search-hint-item"><kbd>Alt+1..8</kbd> Módulos</span>
            <span class="search-hint-item"><kbd>Alt+R</kbd> Atualizar</span>
            <span class="search-hint-item"><kbd>Alt+B</kbd> Barra lateral</span>
          </div>
        </div>
      </div>
    </div>

    <!-- ─────────────────────────────────────────────────── -->
    <!-- TOAST / NOTIFICATION AREA                             -->
    <!-- ─────────────────────────────────────────────────── -->
    <div class="toast-container" id="toastContainer" role="log" aria-live="assertive" aria-label="Notificações"></div>

    <!-- FAB removido — agora gerenciado por TBO_NAVIGATION.initFAB() em navigation-enhancements.js -->

    <!-- TIMER WIDGET (Global floating)                         -->
    <!-- ─────────────────────────────────────────────────── -->
    <div id="timerWidget" class="timer-widget" style="display:none;">
      <div class="timer-widget-inner">
        <div class="timer-info">
          <span class="timer-project" id="twProject"></span>
          <span class="timer-task" id="twTask"></span>
        </div>
        <div class="timer-clock" id="twClock">00:00:00</div>
        <button class="btn btn-sm" id="twStopBtn" title="Parar timer">Parar</button>
      </div>
    </div>

  </div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- LOGIN SCREEN                                            -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div class="login-overlay" id="loginOverlay">
    <div class="login-card">
      <img class="login-logo" src="assets/logo-dark.svg" alt="TBO" draggable="false">
      <h2 class="login-title">TBO OS</h2>
      <p class="login-subtitle">Sistema Operacional do Studio TBO</p>

      <!-- Google OAuth -->
      <button class="btn login-google-btn" id="loginGoogleBtn">
        <svg width="18" height="18" viewBox="0 0 18 18" fill="none" aria-hidden="true"><path d="M17.64 9.205c0-.639-.057-1.252-.164-1.841H9v3.481h4.844a4.14 4.14 0 0 1-1.796 2.716v2.259h2.908c1.702-1.567 2.684-3.875 2.684-6.615z" fill="#4285F4"/><path d="M9 18c2.43 0 4.467-.806 5.956-2.18l-2.908-2.259c-.806.54-1.837.86-3.048.86-2.344 0-4.328-1.584-5.036-3.711H.957v2.332A8.997 8.997 0 0 0 9 18z" fill="#34A853"/><path d="M3.964 10.71A5.41 5.41 0 0 1 3.682 9c0-.593.102-1.17.282-1.71V4.958H.957A8.997 8.997 0 0 0 0 9c0 1.452.348 2.827.957 4.042l3.007-2.332z" fill="#FBBC05"/><path d="M9 3.58c1.321 0 2.508.454 3.44 1.345l2.582-2.58C13.463.891 11.426 0 9 0A8.997 8.997 0 0 0 .957 4.958L3.964 6.29C4.672 4.163 6.656 2.58 9 2.58z" fill="#EA4335"/></svg>
        Entrar com Google
      </button>

      <!-- Divider -->
      <div class="login-divider">
        <div class="login-divider-line"></div>
        <span class="login-divider-text">ou</span>
        <div class="login-divider-line"></div>
      </div>

      <!-- Email login -->
      <div class="form-group">
        <label class="form-label" for="loginEmail">Email</label>
        <input type="email" class="form-input" id="loginEmail" placeholder="seu@agenciatbo.com.br" autocomplete="email">
      </div>

      <!-- Login legado removido em v2.1 — Supabase Auth e a unica via de acesso -->

      <div class="form-group">
        <label class="form-label" for="loginPass">Senha</label>
        <input type="password" class="form-input" id="loginPass" placeholder="Digite sua senha" autocomplete="current-password">
      </div>
      <button class="btn btn-primary login-submit-btn" id="loginBtn">Entrar</button>
      <button class="btn btn-ghost login-magic-btn" id="loginMagicBtn" style="width:100%;margin-top:8px;font-size:0.85rem;opacity:0.8;">
        Enviar Magic Link por e-mail
      </button>
      <p class="login-error" id="loginError"></p>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- SCRIPTS                                                 -->
  <!-- ═══════════════════════════════════════════════════════ -->

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- PHASE 1: Configuration (MUST load first — provides ONBOARDING_CONFIG) -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <script defer src="config.js"></script>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- PHASE 2: SRC/ ARCHITECTURE LAYER (v3.0 Enterprise)     -->
  <!-- Core → Infra → App (carregam ANTES dos módulos)        -->
  <!-- ═══════════════════════════════════════════════════════ -->

  <!-- Core: Observability (sem dependências) -->
  <script defer src="src/core/observability/logger.js"></script>
  <script defer src="src/core/observability/errors.js"></script>

  <!-- Core: Security & Validation (sem dependências) -->
  <script defer src="src/core/security/sanitize.js"></script>
  <script defer src="src/core/validation/schemas.js"></script>

  <!-- Core: RBAC Engine (depende de TBO_AUTH — carregado depois, usa typeof check) -->
  <script defer src="src/core/permissions/engine.js"></script>

  <!-- App: Config (depende de TBO_LOGGER) -->
  <script defer src="src/app/config/index.js"></script>

  <!-- Infra: Supabase Single Client (depende de ONBOARDING_CONFIG via config.js) -->
  <script defer src="src/infra/supabase/client.js"></script>

  <!-- Infra: HTTP Fetcher (sem dependências) -->
  <script defer src="src/infra/http/fetcher.js"></script>

  <!-- Infra: Storage (depende de TBO_DB) -->
  <script defer src="src/infra/supabase/storage/index.js"></script>

  <!-- Infra: Repositories (dependem de TBO_DB + TBO_AUTH) -->
  <script defer src="src/infra/supabase/queries/_base.js"></script>
  <script defer src="src/infra/supabase/queries/projects.js"></script>
  <script defer src="src/infra/supabase/queries/people.js"></script>
  <script defer src="src/infra/supabase/queries/finance.js"></script>
  <script defer src="src/infra/supabase/queries/chat.js"></script>
  <script defer src="src/infra/supabase/queries/crm.js"></script>
  <script defer src="src/infra/supabase/queries/audit.js"></script>

  <!-- Infra: Integration Contracts -->
  <script defer src="src/infra/integrations/rdstation/index.js"></script>
  <script defer src="src/infra/integrations/omie/index.js"></script>
  <script defer src="src/infra/integrations/fireflies/index.js"></script>
  <script defer src="src/infra/integrations/google-calendar/index.js"></script>

  <!-- App: Route Registry -->
  <script defer src="src/app/routes/index.js"></script>

  <!-- Shared: Constants & Utils -->
  <script defer src="src/shared/constants/index.js"></script>
  <script defer src="src/shared/utils/index.js"></script>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- PHASE 3: LEGACY LAYER (utils + modules)                -->
  <!-- ═══════════════════════════════════════════════════════ -->

  <!-- Backup Utilities -->
  <script defer src="utils/backup.js"></script>

  <!-- Error Monitor & Performance (v2.1 observabilidade) -->
  <script defer src="utils/error-monitor.js"></script>

  <!-- Supabase Wrapper (must load after CDN, before storage) -->
  <script defer src="utils/supabase.js"></script>

  <!-- Google Sheets Integration (live financial data) -->
  <script defer src="utils/google-sheets.js"></script>

  <!-- Fireflies.ai Integration (live meeting data) -->
  <script defer src="utils/fireflies.js"></script>

  <!-- RD Station CRM Integration (unilateral: RD → TBO) -->
  <script defer src="utils/rd-station.js"></script>

  <!-- Google Calendar Integration (read-only) -->
  <script defer src="utils/google-calendar.js"></script>
  <!-- Parsers financeiros (OFX/CSV) -->
  <script defer src="utils/ofx-parser.js"></script>
  <script defer src="utils/csv-parser.js"></script>
  <!-- PDF Export -->
  <script defer src="utils/pdf-export.js"></script>

  <!-- Utility Libraries -->
  <script defer src="utils/api.js"></script>
  <script defer src="utils/storage.js"></script>
  <script defer src="utils/formatter.js"></script>
  <script defer src="utils/toast.js"></script>
  <script defer src="utils/router.js"></script>
  <script defer src="utils/shortcuts.js"></script>
  <script defer src="utils/search.js"></script>
  <script defer src="utils/ux.js"></script>
  <script defer src="utils/notifications.js"></script>

  <!-- Permissions & RBAC -->
  <script defer src="utils/permissions.js"></script>

  <!-- Auth System -->
  <script defer src="utils/auth.js?v=2026022003"></script>

  <!-- ERP Core Engine -->
  <script defer src="utils/erp-core.js"></script>

  <!-- Workload Engine (Timer, Timesheet, Capacity, Cost) -->
  <script defer src="utils/workload.js"></script>

  <!-- Module Scripts -->
  <script defer src="modules/placeholder.js"></script>
  <script defer src="modules/alerts.js"></script>
  <script defer src="modules/pipeline.js"></script>
  <script defer src="modules/clientes.js"></script>
  <script defer src="data/contratos-data.js"></script>
  <script defer src="modules/contratos.js"></script>
  <script defer src="modules/inteligencia.js"></script>
  <script defer src="modules/inteligencia-imobiliaria.js"></script>
  <script defer src="modules/people-profile.js"></script>
  <script defer src="data/cultura-data.js"></script>
  <script defer src="modules/cultura.js"></script>
  <script defer src="modules/command-center.js"></script>
  <script defer src="modules/conteudo.js"></script>
  <script defer src="modules/comercial.js"></script>
  <script defer src="modules/projetos.js"></script>
  <script defer src="modules/project-workspace.js"></script>
  <script defer src="modules/mercado.js"></script>
  <script defer src="modules/reunioes.js"></script>
  <script defer src="modules/financeiro.js"></script>
  <script defer src="modules/rh.js"></script>
  <script defer src="modules/configuracoes.js"></script>
  <script defer src="modules/changelog.js"></script>
  <script defer src="modules/tarefas.js"></script>
  <script defer src="modules/entregas.js"></script>
  <script defer src="modules/revisoes.js"></script>
  <script defer src="modules/decisoes.js"></script>
  <!-- timesheets e carga-trabalho removidos em v2.2 -->
  <script defer src="modules/pagar.js"></script>
  <script defer src="modules/receber.js"></script>
  <script defer src="modules/margens.js"></script>
  <script defer src="modules/conciliacao.js"></script>
  <script defer src="modules/templates.js"></script>
  <script defer src="modules/biblioteca.js"></script>
  <!-- capacidade removido em v2.2 -->
  <script defer src="modules/permissoes-config.js"></script>
  <script defer src="modules/integracoes.js"></script>
  <script defer src="modules/trilha-aprendizagem.js"></script>
  <script defer src="modules/pessoas-avancado.js"></script>
  <script defer src="modules/portal-cliente.js"></script>

  <!-- Admin Portal — sub-modulos (carregar ANTES do orquestrador) -->
  <script defer src="modules/admin/users-tab.js"></script>
  <script defer src="modules/admin/roles-tab.js"></script>
  <script defer src="modules/admin/permissions-tab.js"></script>
  <script defer src="modules/admin/audit-tab.js"></script>

  <!-- Novos modulos v2.2 -->
  <script defer src="modules/admin-portal.js"></script>
  <script defer src="modules/conciliacao-bancaria.js"></script>
  <script defer src="modules/onboarding-wizard.js"></script>
  <!-- academy-catalogo.js removido do boot — desativado para performance (v2.6) -->
  <script defer src="modules/chat.js?v=2026022004"></script>

  <!-- Workspace Selector (Multi-tenant v2) -->
  <script defer src="modules/workspace-selector.js"></script>

  <!-- Onboarding System -->
  <script defer src="js/supabase-client.js"></script>
  <script defer src="js/onboarding-guard.js"></script>
  <script defer src="js/notificacoes.js"></script>
  <script defer src="js/admin-onboarding.js"></script>

  <!-- UI Components (dropzone, skeleton, color picker, auto-refresh, count-up, parallax) -->
  <script defer src="utils/ui-components.js"></script>

  <!-- Workflow Engine (templates de fluxo, conectores entre modulos) -->
  <script defer src="utils/workflow-engine.js"></script>

  <!-- Realtime Engine (subscriptions ERP, presence, KPIs live) -->
  <script defer src="utils/realtime-engine.js"></script>

  <!-- Digest Engine (resumo diario/semanal, relatorio financeiro) -->
  <script defer src="utils/digest-engine.js"></script>

  <!-- Document Versions (versionamento, upload, rollback, preview) -->
  <script defer src="utils/document-versions.js"></script>

  <!-- Dynamic Templates (propostas, contratos, emails com {{variaveis}}) -->
  <script defer src="utils/dynamic-templates.js"></script>

  <!-- Enhancement Modules (100 improvements - v2.2.0) -->
  <script defer src="utils/design-system.js"></script>
  <script defer src="utils/ux-enhancements.js"></script>
  <script defer src="utils/business-intelligence.js"></script>
  <script defer src="utils/project-enhancements.js"></script>
  <script defer src="utils/financial-enhancements.js"></script>
  <script defer src="utils/people-enhancements.js"></script>
  <script defer src="utils/analytics-enhancements.js"></script>
  <script defer src="utils/navigation-enhancements.js"></script>
  <script defer src="utils/integrations-enhancements.js"></script>
  <script defer src="utils/performance-enhancements.js"></script>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- PHASE 4: Bootstrap (APÓS config + utils + módulos)     -->
  <!-- Inicializa TBO_DB, error handlers, route registry      -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <script defer src="src/app/entrypoints/bootstrap.js"></script>

  <!-- Main Application Entry Point (ÚLTIMO — wiring final) -->
  <script defer src="app.js?v=2026022003"></script>

</body>
</html>
