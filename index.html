<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="TBO OS - Sistema operacional do estudio TBO Arquitetura & Visualizacao">
  <title>TBO OS - Painel de Comando</title>

  <!-- Typography: Helvetica Neue LT Pro (local brand font) -->

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="assets/favicon.png">

  <!-- Leaflet Map Library -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>

  <!-- Lucide Icons (stroke/outline, consistent style) -->
  <script src="https://unpkg.com/lucide@0.468.0/dist/umd/lucide.js"></script>

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- SIDEBAR NAVIGATION                                      -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <aside id="sidebar" class="sidebar" role="navigation" aria-label="Navegacao principal">
    <!-- Brand — click to return to Dashboard -->
    <a href="#command-center" class="sidebar-brand" id="brandLink" title="Voltar ao Dashboard">
      <img class="brand-logo-svg" src="assets/logo-dark.svg" alt="TBO - think. build. own" draggable="false">
      <span class="brand-label">Operating System</span>
    </a>

    <!-- Navigation Modules (generated dynamically by app.js from permissions._sections) -->
    <nav class="sidebar-nav" id="sidebarNav">
      <!-- Populated by TBO_APP._renderSidebar() after login -->
    </nav>

    <!-- Sidebar User Widget (populated by auth.js) -->
    <div class="sidebar-user" id="sidebarUserWidget"></div>

    <!-- Sidebar Footer -->
    <div class="sidebar-footer">
      <div class="sidebar-version">v1.0.0</div>
      <button class="sidebar-collapse-btn" id="sidebarToggle" title="Recolher menu" aria-label="Recolher barra lateral">
        <i data-lucide="chevron-left" aria-hidden="true"></i>
      </button>
    </div>

    <!-- Sidebar Resize Handle -->
    <div class="sidebar-resize-handle" id="sidebarResizeHandle" title="Arrastar para redimensionar"></div>
  </aside>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- MAIN LAYOUT                                             -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div id="app-container" class="app-container">

    <!-- ─────────────────────────────────────────────────── -->
    <!-- HEADER                                                -->
    <!-- ─────────────────────────────────────────────────── -->
    <header id="app-header" class="app-header" role="banner">
      <div class="header-left">
        <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Abrir menu" aria-expanded="false">
          <i data-lucide="menu" aria-hidden="true"></i>
        </button>
        <h1 class="header-title" id="headerTitle">Dashboard</h1>
        <span class="header-breadcrumb" id="headerBreadcrumb"></span>
      </div>

      <div class="header-right">
        <!-- Status Indicators -->
        <div class="status-indicators" role="status" aria-label="Status dos servicos">
          <div class="status-badge" id="statusDrive" title="Google Drive">
            <span class="status-dot" data-status="disconnected"></span>
            <span class="status-label">Drive</span>
          </div>
          <div class="status-badge" id="statusFireflies" title="Fireflies.ai">
            <span class="status-dot" data-status="disconnected"></span>
            <span class="status-label">Fireflies</span>
          </div>
          <div class="status-badge" id="statusMarket" title="Dados de mercado">
            <span class="status-dot" data-status="stale"></span>
            <span class="status-label">Mercado</span>
          </div>
          <div class="status-badge" id="statusAPI" title="Chave de API">
            <span class="status-dot" data-status="disconnected"></span>
            <span class="status-label">API</span>
          </div>
        </div>

        <!-- Data Freshness -->
        <div class="header-freshness" id="dataFreshness" title="Ultima atualizacao dos dados">
          <i data-lucide="clock" class="freshness-icon" aria-hidden="true"></i>
          <span class="freshness-text">--</span>
        </div>

        <!-- Quick Actions -->
        <button class="header-action-btn" id="refreshBtn" title="Atualizar dados" aria-label="Atualizar dados">
          <i data-lucide="refresh-cw" aria-hidden="true"></i>
        </button>
        <button class="header-action-btn" id="searchBtn" title="Busca rapida" aria-label="Abrir busca rapida">
          <i data-lucide="search" aria-hidden="true"></i>
        </button>

        <!-- User Menu (populated dynamically by auth.js) -->
        <div class="user-menu" id="userMenu"></div>
      </div>
    </header>

    <!-- ─────────────────────────────────────────────────── -->
    <!-- MAIN CONTENT AREA                                     -->
    <!-- ─────────────────────────────────────────────────── -->
    <main id="main-content" class="main-content" role="main" aria-live="polite">
      <!-- Module content loads here dynamically -->
      <div class="module-loading" id="moduleLoading">
        <div class="loading-spinner"></div>
        <p class="loading-text">Carregando modulo...</p>
      </div>

      <div class="module-container" id="moduleContainer">
        <!-- Active module renders here -->
      </div>

      <!-- Empty state / Welcome -->
      <div class="module-empty" id="moduleEmpty" style="display:none;">
        <div class="empty-illustration" aria-hidden="true">&#x1F3DB;&#xFE0F;</div>
        <h2 class="empty-title">Bem-vindo ao TBO OS</h2>
        <p class="empty-description">
          Selecione um modulo na barra lateral para comecar.
          <br>
          Use <kbd>Alt+1</kbd> a <kbd>Alt+8</kbd> para navegar rapidamente.
        </p>
      </div>
    </main>

    <!-- ─────────────────────────────────────────────────── -->
    <!-- SEARCH MODAL (Quick Command Palette)                  -->
    <!-- ─────────────────────────────────────────────────── -->
    <div class="search-overlay" id="searchOverlay" role="dialog" aria-modal="true" aria-label="Busca rapida" hidden>
      <div class="search-modal">
        <div class="search-input-wrapper">
          <i data-lucide="search" class="search-input-icon" aria-hidden="true"></i>
          <input
            type="text"
            id="searchInput"
            class="search-input"
            placeholder="Buscar modulos, projetos, clientes..."
            autocomplete="off"
            spellcheck="false"
          >
          <kbd class="search-dismiss-hint">Esc</kbd>
        </div>
        <div class="search-filters" id="searchFilters">
          <button class="search-filter-chip active" data-filter="all">Tudo</button>
          <button class="search-filter-chip" data-filter="projeto_ativo">Projetos</button>
          <button class="search-filter-chip" data-filter="cliente">Clientes</button>
          <button class="search-filter-chip" data-filter="reuniao">Reunioes</button>
          <button class="search-filter-chip" data-filter="modulo">Modulos</button>
        </div>
        <div class="search-results" id="searchResults">
          <div class="search-hint">
            Digite para buscar ou use atalhos:
            <span class="search-hint-item"><kbd>Alt+1..8</kbd> Modulos</span>
            <span class="search-hint-item"><kbd>Alt+R</kbd> Atualizar</span>
            <span class="search-hint-item"><kbd>Alt+B</kbd> Barra lateral</span>
          </div>
        </div>
      </div>
    </div>

    <!-- ─────────────────────────────────────────────────── -->
    <!-- TOAST / NOTIFICATION AREA                             -->
    <!-- ─────────────────────────────────────────────────── -->
    <div class="toast-container" id="toastContainer" role="log" aria-live="assertive" aria-label="Notificacoes"></div>

    <!-- TIMER WIDGET (Global floating)                         -->
    <!-- ─────────────────────────────────────────────────── -->
    <div id="timerWidget" class="timer-widget" style="display:none;">
      <div class="timer-widget-inner">
        <div class="timer-info">
          <span class="timer-project" id="twProject"></span>
          <span class="timer-task" id="twTask"></span>
        </div>
        <div class="timer-clock" id="twClock">00:00:00</div>
        <button class="btn btn-sm" id="twStopBtn" title="Parar timer">Parar</button>
      </div>
    </div>

  </div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- LOGIN SCREEN                                            -->
  <!-- ═══════════════════════════════════════════════════════ -->
  <div class="login-overlay" id="loginOverlay">
    <div class="login-card">
      <img class="login-logo" src="assets/logo-dark.svg" alt="TBO" draggable="false">
      <h2 class="login-title">TBO OS</h2>
      <p class="login-subtitle">Sistema Operacional do Studio TBO</p>
      <div class="form-group" style="margin-top:24px;">
        <label class="form-label" for="loginUser">Usuario</label>
        <select class="form-input" id="loginUser">
          <option value="">Selecione...</option>
          <optgroup label="Diretoria">
            <option value="marco">Marco Andolfato (Dir. Operacoes)</option>
            <option value="ruy">Ruy Lima (Dir. Comercial)</option>
          </optgroup>
          <optgroup label="Coordenacao & POs">
            <option value="carol">Carol (Coord. Atendimento)</option>
            <option value="nelson">Nelson (PO Branding)</option>
            <option value="nath">Nathalia (PO Digital 3D)</option>
            <option value="rafa">Rafa (PO Marketing)</option>
            <option value="dann">Danniel (Lider Tecnico 3D)</option>
          </optgroup>
          <optgroup label="Time">
            <option value="gustavo">Gustavo (Comercial)</option>
            <option value="celso">Celso (Designer)</option>
            <option value="erick">Erick (Designer)</option>
            <option value="duda">Duda (Artista 3D)</option>
            <option value="tiago">Tiago M. (Artista 3D)</option>
            <option value="mari">Mariane (Artista 3D)</option>
            <option value="lucca">Lucca (Analista Marketing)</option>
          </optgroup>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label" for="loginPass">Senha</label>
        <input type="password" class="form-input" id="loginPass" placeholder="Digite sua senha">
      </div>
      <button class="btn btn-primary" id="loginBtn" style="width:100%;margin-top:16px;">Entrar</button>
      <p class="login-error" id="loginError" style="display:none;"></p>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════════ -->
  <!-- SCRIPTS                                                 -->
  <!-- ═══════════════════════════════════════════════════════ -->

  <!-- Configuration (API keys, endpoints, feature flags) -->
  <script src="config.js"></script>

  <!-- Utility Libraries -->
  <script src="utils/api.js"></script>
  <script src="utils/storage.js"></script>
  <script src="utils/formatter.js"></script>
  <script src="utils/toast.js"></script>
  <script src="utils/router.js"></script>
  <script src="utils/shortcuts.js"></script>
  <script src="utils/search.js"></script>
  <script src="utils/ux.js"></script>

  <!-- Permissions & RBAC -->
  <script src="utils/permissions.js"></script>

  <!-- Auth System -->
  <script src="utils/auth.js"></script>

  <!-- ERP Core Engine -->
  <script src="utils/erp-core.js"></script>

  <!-- Workload Engine (Timer, Timesheet, Capacity, Cost) -->
  <script src="utils/workload.js"></script>

  <!-- Module Scripts -->
  <script src="modules/placeholder.js"></script>
  <script src="modules/command-center.js"></script>
  <script src="modules/conteudo.js"></script>
  <script src="modules/comercial.js"></script>
  <script src="modules/projetos.js"></script>
  <script src="modules/mercado.js"></script>
  <script src="modules/reunioes.js"></script>
  <script src="modules/financeiro.js"></script>
  <script src="modules/rh.js"></script>
  <script src="modules/configuracoes.js"></script>

  <!-- Main Application Entry Point -->
  <script src="app.js"></script>

</body>
</html>
